<!--
  c-137 Labs Rules |
  Rules ID: 115000 - 115499
-->

<var name="C_FREQ">5</var> <!-- attempts -->
<var name="C_FRAME">180</var> <!-- 3m -->

<group name="al3rt,UBA,">
  <!-- Windows Security.evtx -->
  <rule overwrite="yes" id="60204" level="10" frequency="$C_FREQ" timeframe="$C_FRAME"> <!-- 115000 -->
    <if_matched_group>authentication_failed</if_matched_group>
    <same_field>win.eventdata.targetUserName</same_field>
    <description>UBA : Bruteforce Authentication Attempts (Vertical)</description>
    <options>no_full_log</options>
    <info type="link">https://www.ibm.com/docs/en/qradar-common?topic=authentication-uba-bruteforce-attempts</info>
    <group>windows,windows_security,authentication_failures,</group>
    <mitre>
      <id>T1110.001</id>
    </mitre>
  </rule>
  <rule id="115001" level="10" frequency="$C_FREQ" timeframe="$C_FRAME">
    <if_matched_group>authentication_failed</if_matched_group>
    <different_field>win.eventdata.targetUserName</different_field>
    <description>UBA : Bruteforce Authentication Attempts (Horizontal)</description>
    <options>no_full_log</options>
    <info type="link">https://www.ibm.com/docs/en/qradar-common?topic=authentication-uba-bruteforce-attempts</info>
    <group>windows,windows_security,authentication_failures,</group>
    <mitre>
      <id>T1110.003</id>
    </mitre>
  </rule>

  <!-- Linux auth.log -->
  <rule overwrite="yes" id="5763" level="10" frequency="$C_FREQ" timeframe="$C_FRAME"> <!-- 115002 -->
    <if_matched_sid>5760</if_matched_sid>
    <same_user /> <!-- existing dstuser -->
    <description>UBA : Bruteforce Authentication Attempts (Vertical)</description>
    <options>no_full_log</options>
    <info type="link">https://www.ibm.com/docs/en/qradar-common?topic=authentication-uba-bruteforce-attempts</info>
    <group>syslog,sshd,authentication_failures,</group>
    <mitre>
      <id>T1110.001</id>
    </mitre>
  </rule>
  <rule id="115003" level="10" frequency="$C_FREQ" timeframe="$C_FRAME"> <!-- 115003 -->
    <if_matched_sid>5760</if_matched_sid>
    <different_user /> <!-- existing dstuser -->
    <description>UBA : Bruteforce Authentication Attempts (Horizontal)</description>
    <options>no_full_log</options>
    <info type="link">https://www.ibm.com/docs/en/qradar-common?topic=authentication-uba-bruteforce-attempts</info>
    <group>syslog,sshd,authentication_failures,</group>
    <mitre>
      <id>T1110.003</id>
    </mitre>
  </rule>

  <rule overwrite="yes" id="5712" level="10" frequency="$C_FREQ" timeframe="$C_FRAME"> <!-- 115004 -->
    <if_matched_sid>5710</if_matched_sid>
    <same_srcuser /> <!-- srcuser doesn't exist -->
    <description>UBA : Bruteforce Authentication Attempts (Vertical)</description>
    <options>no_full_log</options>
    <info type="link">https://www.ibm.com/docs/en/qradar-common?topic=authentication-uba-bruteforce-attempts</info>
    <group>syslog,sshd,authentication_failures,</group>
    <mitre>
      <id>T1110.001</id>
    </mitre>
  </rule>
  <rule id="115005" level="10" frequency="$C_FREQ" timeframe="$C_FRAME"> <!-- 115005 -->
    <if_matched_sid>5710</if_matched_sid>
    <different_srcuser /> <!-- srcuser doesn't exist -->
    <description>UBA : Bruteforce Authentication Attempts (Horizontal)</description>
    <options>no_full_log</options>
    <info type="link">https://www.ibm.com/docs/en/qradar-common?topic=authentication-uba-bruteforce-attempts</info>
    <group>syslog,sshd,authentication_failures,</group>
    <mitre>
      <id>T1110.003</id>
    </mitre>
  </rule>
</group>
